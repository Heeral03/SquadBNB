import{cl as b,b6 as $,cg as f,bc as l,b_ as c,B as u,cm as z,dd as k,c3 as H,bX as A,a1 as B,de as N,w as O,bs as I,cr as v}from"./index-BDcKlTkx.js";const j=`Ethereum Signed Message:
`;function C(e){const t=typeof e=="string"?b(e):typeof e.raw=="string"?e.raw:$(e.raw),n=b(`${j}${f(t)}`);return l([n,t])}function L(e,t){return c(C(e),t)}class R extends u{constructor({domain:t}){super(`Invalid domain "${z(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class W extends u{constructor({primaryType:t,types:n}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(n))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class F extends u{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function V(e){const{domain:t,message:n,primaryType:s,types:a}=e,r=(i,d)=>{for(const D of i){const{name:P,type:p}=D,o=d[P],m=p.match(k);if(m&&(typeof o=="number"||typeof o=="bigint")){const[S,y,M]=m;H(o,{signed:y==="int",size:Number.parseInt(M,10)/8})}if(p==="address"&&typeof o=="string"&&!A(o))throw new B({address:o});const h=p.match(N);if(h){const[S,y]=h;if(y&&f(o)!==Number.parseInt(y,10))throw new O({expectedSize:Number.parseInt(y,10),givenSize:f(o)})}const g=a[p];g&&(X(p),r(g,o))}};if(a.EIP712Domain&&t){if(typeof t!="object")throw new R({domain:t});r(a.EIP712Domain,t)}if(s!=="EIP712Domain")if(a[s])r(a[s],n);else throw new W({primaryType:s,types:a})}function J({domain:e}){return[typeof e?.name=="string"&&{name:"name",type:"string"},e?.version&&{name:"version",type:"string"},(typeof e?.chainId=="number"||typeof e?.chainId=="bigint")&&{name:"chainId",type:"uint256"},e?.verifyingContract&&{name:"verifyingContract",type:"address"},e?.salt&&{name:"salt",type:"bytes32"}].filter(Boolean)}function X(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new F({type:e})}function Q(e){const{domain:t={},message:n,primaryType:s}=e,a={EIP712Domain:J({domain:t}),...e.types};V({domain:t,message:n,primaryType:s,types:a});const r=["0x1901"];return t&&r.push(_({domain:t,types:a})),s!=="EIP712Domain"&&r.push(T({data:n,primaryType:s,types:a})),c(l(r))}function _({domain:e,types:t}){return T({data:e,primaryType:"EIP712Domain",types:t})}function T({data:e,primaryType:t,types:n}){const s=x({data:e,primaryType:t,types:n});return c(s)}function x({data:e,primaryType:t,types:n}){const s=[{type:"bytes32"}],a=[q({primaryType:t,types:n})];for(const r of n[t]){const[i,d]=w({types:n,name:r.name,type:r.type,value:e[r.name]});s.push(i),a.push(d)}return I(s,a)}function q({primaryType:e,types:t}){const n=v(G({primaryType:e,types:t}));return c(n)}function G({primaryType:e,types:t}){let n="";const s=E({primaryType:e,types:t});s.delete(e);const a=[e,...Array.from(s).sort()];for(const r of a)n+=`${r}(${t[r].map(({name:i,type:d})=>`${d} ${i}`).join(",")})`;return n}function E({primaryType:e,types:t},n=new Set){const a=e.match(/^\w*/u)?.[0];if(n.has(a)||t[a]===void 0)return n;n.add(a);for(const r of t[a])E({primaryType:r.type,types:t},n);return n}function w({types:e,name:t,type:n,value:s}){if(e[n]!==void 0)return[{type:"bytes32"},c(x({data:s,primaryType:n,types:e}))];if(n==="bytes")return[{type:"bytes32"},c(s)];if(n==="string")return[{type:"bytes32"},c(v(s))];if(n.lastIndexOf("]")===n.length-1){const a=n.slice(0,n.lastIndexOf("[")),r=s.map(i=>w({name:t,type:a,types:e,value:i}));return[{type:"bytes32"},c(I(r.map(([i])=>i),r.map(([,i])=>i)))]}return[{type:n},s]}export{R as I,W as a,F as b,L as c,T as d,Q as e,J as g,_ as h,j as p,C as t,V as v};
